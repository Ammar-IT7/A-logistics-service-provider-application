<!-- Offer Form -->
<div class="offer-form-header">
    <button class="offer-form-header-action" data-action="navigate" data-page="global-request-details">
        <i class="fas fa-arrow-left"></i>
    </button>
    <h1 class="offer-form-header-title">تقديم عرض للطلب العام #GLB-2024-1253</h1>
    <button class="offer-form-header-action" data-action="save-draft" aria-label="حفظ كمسودة">
        <i class="fas fa-save"></i>
    </button>
</div>

<div class="offer-form-content">
    <!-- Progress Bar -->
    <div class="offer-form-progress-bar">
        <div class="offer-form-progress-step active" data-step="1">
            <div class="offer-form-progress-number">1</div>
            <div class="offer-form-progress-label">معلومات أساسية</div>
        </div>
        <div class="offer-form-progress-step" data-step="2">
            <div class="offer-form-progress-number">2</div>
            <div class="offer-form-progress-label">التسعير</div>
        </div>
        <div class="offer-form-progress-step" data-step="3">
            <div class="offer-form-progress-number">3</div>
            <div class="offer-form-progress-label">المميزات والخدمات</div>
        </div>
        <div class="offer-form-progress-step" data-step="4">
            <div class="offer-form-progress-number">4</div>
            <div class="offer-form-progress-label">الشروط والأحكام</div>
        </div>
    </div>

    <!-- Request Summary -->
    <div class="offer-form-section">
        <h3 class="offer-form-section-title">ملخص الطلب</h3>
        <div class="offer-form-row">
            <div class="offer-form-col">
                <div class="offer-form-group">
                    <label class="offer-form-label">نوع الخدمة</label>
                    <input type="text" class="offer-form-control" value="تخزين" readonly>
                </div>
            </div>
            <div class="offer-form-col">
                <div class="offer-form-group">
                    <label class="offer-form-label">العميل</label>
                    <input type="text" class="offer-form-control" value="شركة التقنية المتقدمة للتجارة" readonly>
                </div>
            </div>
        </div>
        <div class="offer-form-row">
            <div class="offer-form-col">
                <div class="offer-form-group">
                    <label class="offer-form-label">الموقع</label>
                    <input type="text" class="offer-form-control" value="الرياض، المملكة العربية السعودية" readonly>
                </div>
            </div>
            <div class="offer-form-col">
                <div class="offer-form-group">
                    <label class="offer-form-label">المدة</label>
                    <input type="text" class="offer-form-control" value="6 أشهر" readonly>
                </div>
            </div>
        </div>
        <div class="offer-form-row">
            <div class="offer-form-col">
                <div class="offer-form-group">
                    <label class="offer-form-label">الموعد النهائي</label>
                    <input type="text" class="offer-form-control" value="20 يناير 2024" readonly>
                </div>
            </div>
            <div class="offer-form-col">
                <div class="offer-form-group">
                    <label class="offer-form-label">الحالة</label>
                    <input type="text" class="offer-form-control" value="مفتوح للعروض" readonly style="color: #10b981; font-weight: 600;">
                </div>
            </div>
        </div>
    </div>

    <form id="offerForm" class="offer-form">
        <!-- Step 1: Basic Information -->
        <div class="offer-form-slide active" data-step="1">
            <div class="offer-form-section">
                <h3 class="offer-form-section-title">معلومات أساسية</h3>
                
                <div class="offer-form-group">
                    <label class="offer-form-label">عنوان العرض <span class="required">*</span></label>
                    <input type="text" name="offerTitle" class="offer-form-control" placeholder="مثال: عرض تخزين مكيف مع خدمات متقدمة" required>
                </div>

                <div class="offer-form-group">
                    <label class="offer-form-label">وصف العرض <span class="required">*</span></label>
                    <textarea name="offerDescription" class="offer-form-control" rows="4" placeholder="وصف تفصيلي للخدمات المقدمة في هذا العرض" required></textarea>
                </div>

                <div class="offer-form-group">
                    <label class="offer-form-label">موقع الخدمة <span class="required">*</span></label>
                    <input type="text" name="serviceLocation" class="offer-form-control" placeholder="موقع الخدمة المقدمة" required>
                </div>

                <div class="offer-form-group">
                    <label class="offer-form-label">وقت التسليم <span class="required">*</span></label>
                    <select name="deliveryTime" class="offer-form-control" required>
                        <option value="">اختر وقت التسليم</option>
                        <option value="immediate">فوري</option>
                        <option value="24h">خلال 24 ساعة</option>
                        <option value="48h">خلال 48 ساعة</option>
                        <option value="72h">خلال 72 ساعة</option>
                        <option value="custom">مخصص</option>
                    </select>
                </div>

                <div class="offer-form-group">
                    <label class="offer-form-label">صلاحية العرض <span class="required">*</span></label>
                    <select name="offerValidity" class="offer-form-control" required>
                        <option value="">اختر مدة الصلاحية</option>
                        <option value="3">3 أيام</option>
                        <option value="7">7 أيام</option>
                        <option value="14">14 يوم</option>
                        <option value="30">30 يوم</option>
                        <option value="custom">مخصص</option>
                    </select>
                </div>

                <div class="offer-form-group">
                    <label class="offer-form-label">الشخص المسؤول <span class="required">*</span></label>
                    <input type="text" name="contactPerson" class="offer-form-control" placeholder="اسم الشخص المسؤول عن هذا العرض" required>
                </div>
            </div>
        </div>

        <!-- Step 2: Pricing -->
        <div class="offer-form-slide" data-step="2">
            <div class="offer-form-section">
                <h3 class="offer-form-section-title">التسعير</h3>
                
                <div class="offer-form-group">
                    <label class="offer-form-label">السعر الأساسي <span class="required">*</span></label>
                    <div class="offer-form-row">
                        <div class="offer-form-col">
                            <input type="number" name="basePrice" class="offer-form-control" placeholder="0" min="0" step="0.01" required>
                        </div>
                        <div class="offer-form-col">
                            <select name="priceUnit" class="offer-form-control" required>
                                <option value="">الوحدة</option>
                                <option value="monthly">شهرياً</option>
                                <option value="quarterly">ربع سنوي</option>
                                <option value="yearly">سنوياً</option>
                                <option value="one-time">مرة واحدة</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="offer-form-group">
                    <label class="offer-form-label">نسبة الخصم</label>
                    <div class="offer-form-row">
                        <div class="offer-form-col">
                            <input type="number" name="discountPercentage" class="offer-form-control" placeholder="0" min="0" max="100">
                        </div>
                        <div class="offer-form-col">
                            <input type="text" name="finalPrice" class="offer-form-control" placeholder="سيتم الحساب تلقائياً" readonly>
                        </div>
                    </div>
                </div>

                <div class="offer-form-group">
                    <label class="offer-form-label">شروط الدفع <span class="required">*</span></label>
                    <select name="paymentTerms" class="offer-form-control" required>
                        <option value="">اختر شروط الدفع</option>
                        <option value="advance">دفع مقدم</option>
                        <option value="monthly">دفع شهري</option>
                        <option value="quarterly">دفع ربع سنوي</option>
                        <option value="custom">شروط مخصصة</option>
                    </select>
                </div>

                <div class="offer-form-group">
                    <label class="offer-form-label">رسوم إضافية</label>
                    <textarea name="additionalFees" class="offer-form-control" rows="3" placeholder="أي رسوم إضافية أو شروط خاصة بالدفع"></textarea>
                </div>
            </div>
        </div>

        <!-- Step 3: Features and Services -->
        <div class="offer-form-slide" data-step="3">
            <div class="offer-form-section">
                <h3 class="offer-form-section-title">المميزات والخدمات</h3>
                
                <div class="offer-form-group">
                    <label class="offer-form-label">المميزات المقدمة</label>
                    <div class="offer-form-features-container">
                        <div class="offer-form-feature-input">
                            <input type="text" id="featureInput" class="offer-form-control" placeholder="مثال: تخزين مكيف">
                            <button type="button" class="btn btn-outline btn-sm" id="addFeature">
                                <i class="fas fa-plus"></i>
                                إضافة
                            </button>
                        </div>
                        <div id="offerFeaturesChips" class="offer-form-chips-container">
                            <div class="offer-form-chip">
                                <span>تخزين مكيف</span>
                                <span class="offer-form-chip-close" onclick="removeChip(this)">×</span>
                            </div>
                            <div class="offer-form-chip">
                                <span>نظام أمان متقدم</span>
                                <span class="offer-form-chip-close" onclick="removeChip(this)">×</span>
                            </div>
                            <div class="offer-form-chip">
                                <span>خدمة 24/7</span>
                                <span class="offer-form-chip-close" onclick="removeChip(this)">×</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="offer-form-group">
                    <label class="offer-form-label">الخدمات الإضافية</label>
                    <div class="offer-form-results-container">
                        <div class="offer-form-result-item">
                            <input type="text" name="serviceNames[]" class="offer-form-control" placeholder="اسم الخدمة" value="خدمة التغليف">
                            <input type="number" name="servicePrices[]" class="offer-form-control" placeholder="السعر" value="500">
                            <button type="button" class="btn btn-outline btn-sm" onclick="removeResult(this)">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                        <div class="offer-form-result-item">
                            <input type="text" name="serviceNames[]" class="offer-form-control" placeholder="اسم الخدمة" value="خدمة النقل">
                            <input type="number" name="servicePrices[]" class="offer-form-control" placeholder="السعر" value="300">
                            <button type="button" class="btn btn-outline btn-sm" onclick="removeResult(this)">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    <button type="button" class="btn btn-outline btn-sm" id="addService">
                        <i class="fas fa-plus"></i>
                        إضافة خدمة أخرى
                    </button>
                </div>

                <div class="offer-form-group">
                    <label class="offer-form-label">متطلبات خاصة</label>
                    <textarea name="specialRequirements" class="offer-form-control" rows="3" placeholder="أي متطلبات خاصة أو شروط إضافية"></textarea>
                </div>
            </div>
        </div>

        <!-- Step 4: Terms and Conditions -->
        <div class="offer-form-slide" data-step="4">
            <div class="offer-form-section">
                <h3 class="offer-form-section-title">الشروط والأحكام</h3>
                
                <div class="offer-form-group">
                    <label class="offer-form-label">فترة الضمان</label>
                    <select name="warrantyPeriod" class="offer-form-control">
                        <option value="">اختر فترة الضمان</option>
                        <option value="none">لا يوجد ضمان</option>
                        <option value="30">30 يوم</option>
                        <option value="90">90 يوم</option>
                        <option value="180">6 أشهر</option>
                        <option value="365">سنة واحدة</option>
                        <option value="custom">مخصص</option>
                    </select>
                </div>

                <div class="offer-form-group">
                    <label class="offer-form-label">سياسة الإلغاء</label>
                    <select name="cancellationPolicy" class="offer-form-control">
                        <option value="">اختر سياسة الإلغاء</option>
                        <option value="flexible">مرنة</option>
                        <option value="moderate">متوسطة</option>
                        <option value="strict">صارمة</option>
                        <option value="custom">مخصصة</option>
                    </select>
                </div>

                <div class="offer-form-group">
                    <label class="offer-form-label">الشروط والأحكام <span class="required">*</span></label>
                    <textarea name="termsConditions" class="offer-form-control" rows="4" placeholder="الشروط والأحكام الخاصة بهذا العرض" required></textarea>
                </div>

                <div class="offer-form-group">
                    <label class="offer-form-label">التأكيدات</label>
                    <div class="offer-form-checkbox-group">
                        <label class="offer-form-checkbox-item">
                            <input type="checkbox" name="confirmTerms" required>
                            <span class="offer-form-checkmark"></span>
                            أؤكد أن جميع المعلومات المقدمة صحيحة وكاملة
                        </label>
                        <label class="offer-form-checkbox-item">
                            <input type="checkbox" name="confirmPricing" required>
                            <span class="offer-form-checkmark"></span>
                            أؤكد أن الأسعار المقدمة نهائية وملزمة
                        </label>
                        <label class="offer-form-checkbox-item">
                            <input type="checkbox" name="confirmAvailability" required>
                            <span class="offer-form-checkmark"></span>
                            أؤكد أن الخدمة متاحة في المواعيد المحددة
                        </label>
                    </div>
                </div>
            </div>
        </div>

        <!-- Navigation Buttons -->
        <div class="offer-form-navigation">
            <button type="button" class="btn btn-outline" id="prevStep" style="display: none;">
                <i class="fas fa-arrow-right"></i>
                السابق
            </button>
            <button type="button" class="btn btn-primary" id="nextStep">
                التالي
                <i class="fas fa-arrow-left"></i>
            </button>
            <button type="submit" class="btn btn-success" id="submitForm" style="display: none;">
                <i class="fas fa-paper-plane"></i>
                تقديم العرض
            </button>
        </div>
    </form>
</div>

<script>
// Simple test script for step navigation
document.addEventListener('DOMContentLoaded', function() {
    console.log('DOM loaded, testing step navigation...');
    
    let currentStep = 1;
    const totalSteps = 4;
    
    // Get navigation buttons
    const nextBtn = document.getElementById('nextStep');
    const prevBtn = document.getElementById('prevStep');
    const submitBtn = document.getElementById('submitForm');
    
    console.log('Buttons found:', { nextBtn, prevBtn, submitBtn });
    
    // Next button click
    if (nextBtn) {
        nextBtn.addEventListener('click', function() {
            console.log('Next clicked, current step:', currentStep);
            if (currentStep < totalSteps) {
                currentStep++;
                showStep(currentStep);
                updateProgressBar();
                updateNavigationButtons();
            }
        });
    }
    
    // Previous button click
    if (prevBtn) {
        prevBtn.addEventListener('click', function() {
            console.log('Previous clicked, current step:', currentStep);
            if (currentStep > 1) {
                currentStep--;
                showStep(currentStep);
                updateProgressBar();
                updateNavigationButtons();
            }
        });
    }
    
    function showStep(step) {
        console.log('Showing step:', step);
        
        // Hide all slides
        const slides = document.querySelectorAll('.offer-form-slide');
        slides.forEach(slide => {
            slide.classList.remove('active');
        });
        
        // Show current slide
        const currentSlide = document.querySelector(`.offer-form-slide[data-step="${step}"]`);
        if (currentSlide) {
            currentSlide.classList.add('active');
            console.log('Step', step, 'is now active');
        } else {
            console.error('Slide not found for step:', step);
        }
    }
    
    function updateProgressBar() {
        const steps = document.querySelectorAll('.offer-form-progress-step');
        steps.forEach((step, index) => {
            const stepNumber = index + 1;
            step.classList.remove('active', 'completed');
            
            if (stepNumber < currentStep) {
                step.classList.add('completed');
            } else if (stepNumber === currentStep) {
                step.classList.add('active');
            }
        });
    }
    
    function updateNavigationButtons() {
        if (prevBtn) {
            prevBtn.style.display = currentStep > 1 ? 'flex' : 'none';
        }
        
        if (nextBtn) {
            nextBtn.style.display = currentStep < totalSteps ? 'flex' : 'none';
        }
        
        if (submitBtn) {
            submitBtn.style.display = currentStep === totalSteps ? 'flex' : 'none';
        }
    }
    
    // Initialize
    updateProgressBar();
    updateNavigationButtons();
    console.log('Step navigation test initialized');
});
</script> 